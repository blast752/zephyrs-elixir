<Window x:Class="ZephyrsElixir.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:shell="clr-namespace:ZephyrsElixir.UI.Shell"
        mc:Ignorable="d"
        Title="Zephyr's Elixir"
        Width="1400" Height="900"
        MinWidth="1100" MinHeight="700"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        ResizeMode="CanResize"
        AllowsTransparency="True"
        Background="Transparent"
        StateChanged="OnWindowStateChanged"
        SourceInitialized="OnSourceInitialized">

    <Window.Resources>
        <Color x:Key="TitleBarBackgroundColor">#FF0C1528</Color>
        <Color x:Key="ButtonIconColor">#FFFFFFFF</Color>
        <Color x:Key="ButtonHoverColor">#FF2D3142</Color>
        <Color x:Key="ButtonPressColor">#FF1E2230</Color>
        <Color x:Key="CloseHoverColor">#FFE81123</Color>
        <Color x:Key="ClosePressColor">#FFC42B1C</Color>
        <Color x:Key="WindowBorderColor">#FF1A2238</Color>
        
        <SolidColorBrush x:Key="TitleBarBackground" Color="{StaticResource TitleBarBackgroundColor}"/>
        <SolidColorBrush x:Key="ButtonIcon" Color="{StaticResource ButtonIconColor}"/>
        <SolidColorBrush x:Key="ButtonHover" Color="{StaticResource ButtonHoverColor}"/>
        <SolidColorBrush x:Key="ButtonPress" Color="{StaticResource ButtonPressColor}"/>
        <SolidColorBrush x:Key="CloseHoverBrush" Color="{StaticResource CloseHoverColor}"/>
        <SolidColorBrush x:Key="ClosePressBrush" Color="{StaticResource ClosePressColor}"/>
        <SolidColorBrush x:Key="WindowBorder" Color="{StaticResource WindowBorderColor}"/>
        
        <ControlTemplate x:Key="WindowControlButtonTemplate" TargetType="Button">
            <Border x:Name="ButtonBorder"
                    Background="Transparent"
                    Width="46"
                    Height="32"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                <ContentPresenter HorizontalAlignment="Center" 
                                  VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="ButtonBorder" Property="Background" Value="{StaticResource ButtonHover}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter TargetName="ButtonBorder" Property="Background" Value="{StaticResource ButtonPress}"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <ControlTemplate x:Key="CloseButtonTemplate" TargetType="Button">
            <Border x:Name="ButtonBorder"
                    Background="Transparent"
                    Width="46"
                    Height="32"
                    CornerRadius="0,8,0,0"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                <ContentPresenter HorizontalAlignment="Center" 
                                  VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="ButtonBorder" Property="Background" Value="{StaticResource CloseHoverBrush}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter TargetName="ButtonBorder" Property="Background" Value="{StaticResource ClosePressBrush}"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </Window.Resources>

    <Border x:Name="WindowBorder"
            Background="#FF0E1A33"
            BorderBrush="{StaticResource WindowBorder}"
            BorderThickness="1"
            CornerRadius="8">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <Grid Grid.Row="0"
                  Background="{StaticResource TitleBarBackground}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
            
                <StackPanel Grid.Column="0"
                            Orientation="Horizontal"
                            Margin="12,0,0,0"
                            VerticalAlignment="Center">
                    <Image Source="pack://application:,,,/Assets/Images/logo.png"
                        Width="20" Height="20"
                        Margin="0,0,12,0"/>
                    <TextBlock Text="{Binding Title, RelativeSource={RelativeSource AncestorType=Window}}"
                            Foreground="White"
                            FontFamily="{StaticResource AppFontFamily}"
                            FontSize="13"
                            FontWeight="Normal"
                            VerticalAlignment="Center"/>
                </StackPanel>
                
                <Rectangle Grid.Column="1"
                           Fill="Transparent"
                           MouseLeftButtonDown="OnTitleBarMouseDown"
                           WindowChrome.IsHitTestVisibleInChrome="True"/>
                
                <StackPanel Grid.Column="2"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    
                    <Button x:Name="MinimizeButton"
                            Click="OnMinimizeClick"
                            Template="{StaticResource WindowControlButtonTemplate}"
                            ToolTip="Minimize">
                        <Rectangle Width="10" Height="1" Fill="White"/>
                    </Button>
                    
                    <Button x:Name="MaximizeRestoreButton"
                            Click="OnMaximizeClick"
                            Template="{StaticResource WindowControlButtonTemplate}"
                            ToolTip="Maximize">
                        <Canvas x:Name="MaximizeIcon" Width="10" Height="10">
                            <Rectangle Width="10" Height="10"
                                       Stroke="{StaticResource ButtonIcon}"
                                       StrokeThickness="1"/>
                        </Canvas>
                    </Button>
                    
                    <Button x:Name="CloseButton"
                            Click="OnCloseClick"
                            Template="{StaticResource CloseButtonTemplate}"
                            ToolTip="Close">
                        <TextBlock Text="&#xE8BB;" 
                                   FontFamily="{StaticResource AppIconFont}" 
                                   FontSize="10"
                                   Foreground="{StaticResource ButtonIcon}"/>
                    </Button>
                </StackPanel>
            </Grid>
            
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="280"/>
                    <ColumnDefinition Width="1"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0"
                        Background="#FF0A1224">
                    <shell:Sidebar x:Name="AppSidebar"
                                   NavigateRequested="OnSidebarNavigate"
                                   DeviceStatusText="{Binding DeviceStatusText}"
                                   DeviceBattery="{Binding DeviceBatteryPercentage}"/>
                </Border>
                
                <Rectangle Grid.Column="1"
                           Fill="#1A1A1D"/>
                
                <Border Grid.Column="2"
                        Background="#FF0E1A33">
                    <ContentControl x:Name="ContentHost"
                                    HorizontalContentAlignment="Stretch"
                                    VerticalContentAlignment="Stretch"/>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>
